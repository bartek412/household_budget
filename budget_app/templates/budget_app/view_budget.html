{% extends base_path %}
{% block style %}



<style>
    .sidenav_element:hover button{
        color:lightslategray;
    }
</style>

{% endblock %}

{% block sidenav %}

<!-- <div class="accordion" id="accordionExample"> -->
    
    <div class="accordion" id="accordionExample">
        <div class="card bg-transparent border-0">
            <div class="card-header bg-transparent border-0" style="padding:0%;" id="headingOne">
                <div class = 'sidenav_element'>
                        <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" fill="currentColor" class="bi bi-list-check" viewBox="0 0 15 15">
                            <path fill-rule="evenodd" d="M5 11.5a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5zM3.854 2.146a.5.5 0 0 1 0 .708l-1.5 1.5a.5.5 0 0 1-.708 0l-.5-.5a.5.5 0 1 1 .708-.708L2 3.293l1.146-1.147a.5.5 0 0 1 .708 0zm0 4a.5.5 0 0 1 0 .708l-1.5 1.5a.5.5 0 0 1-.708 0l-.5-.5a.5.5 0 1 1 .708-.708L2 7.293l1.146-1.147a.5.5 0 0 1 .708 0zm0 4a.5.5 0 0 1 0 .708l-1.5 1.5a.5.5 0 0 1-.708 0l-.5-.5a.5.5 0 0 1 .708-.708l.146.147 1.146-1.147a.5.5 0 0 1 .708 0z"/>
                        </svg>
                        <button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne" style="text-decoration: none;">
                            Budgets
                        </button>
                </div>
            </div>
            <div id="collapseOne" class="collapse" aria-labelledby="headingOne" data-parent="#accordionExample">
                <div class="card-body" style="padding:10%; padding-top: 0%; padding-bottom: 0%;">
                    <div class="add-budget-button row" style = "background-color:rgb(192, 208, 218);border-radius: 7.5px;">
                        <a class="btn btn-primary w-100" href="/add_budget/" role="button">Add budget</a>
                    </div>
                </div>
                <div class="card-body" style="padding:0%">
                    <ul class="list-group list-group-flush" style="padding-left: 10%; padding-right: 10%;">
                        {% for i in budgets_list %}
                        <li class="list-group-item" style="padding: 0.25rem 0.5rem; background-color: rgb(228, 243, 255);">
                            <a href = '/budgets/{{i.id}}' style="padding-left: 0px; padding-top: 0px; font-size:13px;">{{i.name}}</a>
                        </li>
                        {% endfor %}
                    </ul>
                </div>
            </div>
        </div>
        
    <div class="card bg-transparent border-0">
        <div class="card-header bg-transparent border-0" id="headingTwo" style="padding:0%; height: 74.5px;">
            <div class = 'sidenav_element'>
                    <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" fill="currentColor" class="bi bi-person" viewBox="0 0 15 15">
                        <path d="M8 8a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm2-3a2 2 0 1 1-4 0 2 2 0 0 1 4 0zm4 8c0 1-1 1-1 1H3s-1 0-1-1 1-4 6-4 6 3 6 4zm-1-.004c-.001-.246-.154-.986-.832-1.664C11.516 10.68 10.289 10 8 10c-2.29 0-3.516.68-4.168 1.332-.678.678-.83 1.418-.832 1.664h10z"/>
                    </svg>
                    <button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo" style="text-decoration: none;">
                        Categories
                    </button>
            </div>
        </div>
        <div id="collapseTwo" class="collapse" aria-labelledby="headingTwo" data-parent="#accordionExample">
            <div class="card-body" style="padding:10%; padding-top: 0%; padding-bottom: 0%;">
                {% if owner_or_edit %}
                <div class="add-budget-button row" style = "background-color:rgb(192, 208, 218);border-radius: 7.5px;">
                    <a class = "btn btn-primary w-100" href = "/budgets/{{budget.id}}/add_category" role="button">Add category</a>
                </div>
                {% endif %}
                <ul class="list-group list-group-flush" style="padding-left: 10%; padding-right: 10%;">
                    {% for i in categories %}
                        {% if i.name != "Expense" and i.name != "Income" %}
                            {% if owner_or_edit %}
                            <li class="list-group-item" style="padding: 0.25rem 0.5rem; background-color: rgb(228, 243, 255);">
                                    <a href = '/budgets/{{budget.id}}/category/{{i.id}}/edit/' style="padding-left: 0px; padding-top: 0px; font-size:13px;">{{i.name}}</a>
                                </li>
                            {% else %}

                            {% endif %}
                        {% endif %}
                    {% endfor %}
                </ul>
            </div>
        </div>
    </div>

    <!-- Users in particular budget -->
    <div class="card bg-transparent border-0">
        <div class="card-header bg-transparent border-0" id="headingTwo" style="padding:0%; height: 74.5px;">
            <div class = 'sidenav_element'>
                    <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" fill="currentColor" class="bi bi-person" viewBox="0 0 15 15">
                        <path d="M8 8a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm2-3a2 2 0 1 1-4 0 2 2 0 0 1 4 0zm4 8c0 1-1 1-1 1H3s-1 0-1-1 1-4 6-4 6 3 6 4zm-1-.004c-.001-.246-.154-.986-.832-1.664C11.516 10.68 10.289 10 8 10c-2.29 0-3.516.68-4.168 1.332-.678.678-.83 1.418-.832 1.664h10z"/>
                    </svg>
                    <button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapseTwoBudget" aria-expanded="false" aria-controls="collapseTwo" style="text-decoration: none;">
                        Users
                    </button>
            </div>
        </div>
        <div id="collapseTwoBudget" class="collapse" aria-labelledby="headingTwo" data-parent="#accordionExample">
            <div class="card-body" style="padding:10%; padding-top: 0%; padding-bottom: 0%;">
                {% if owner_or_edit %}
                <div class="add-budget-button row" style = "background-color:rgb(192, 208, 218);border-radius: 7.5px;">
                    <a class = "btn btn-primary w-100" href = "/budgets/{{budget.id}}/add_user" role="button">Add user</a>
                </div>
                {% endif %}
                <ul class="list-group list-group-flush" style="padding-left: 10%; padding-right: 10%;">
                    {% for i in users %}
                            <li class="list-group-item" style="padding: 0.25rem 0.5rem; background-color: rgb(228, 243, 255);">
                                    {{i}}
                                </li>
                    {% endfor %}
                </ul>
            </div>
        </div>
    </div>



    <div class="card bg-transparent border-0">
        <div class="card-header bg-transparent border-0" id="headingTwo" style="padding:0%; height: 74.5px;">
            <div class = 'sidenav_element'>
                    <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" fill="currentColor" class="bi bi-person" viewBox="0 0 15 15">
                        <path d="M8 8a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm2-3a2 2 0 1 1-4 0 2 2 0 0 1 4 0zm4 8c0 1-1 1-1 1H3s-1 0-1-1 1-4 6-4 6 3 6 4zm-1-.004c-.001-.246-.154-.986-.832-1.664C11.516 10.68 10.289 10 8 10c-2.29 0-3.516.68-4.168 1.332-.678.678-.83 1.418-.832 1.664h10z"/>
                    </svg>
                    <button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse_income" aria-expanded="false" aria-controls="collapseTwo" style="text-decoration: none;">
                        Incomes
                    </button>
            </div>
        </div>
        <div id="collapse_income" class="collapse" aria-labelledby="headingTwo" data-parent="#accordionExample">
            <div class="card-body" style="padding:10%; padding-top: 0%; padding-bottom: 0%;">
                {% if owner_or_edit %}
                <div class="add-budget-button row" style = "background-color:rgb(192, 208, 218);border-radius: 7.5px;">
                    <a class = "btn btn-primary w-100" href = "/budgets/{{budget.id}}/add_income" role="button">Add Income</a>
                </div>
                {% endif %}
            </div>
        </div>
    </div>
</div>

<div class="card bg-transparent border-0">
    <div class="card-header bg-transparent border-0" id="headingTwo" style="padding:0%; height: 74.5px;">
        <div class = 'sidenav_element'>
                <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" fill="currentColor" class="bi bi-person" viewBox="0 0 15 15">
                    <path d="M8 8a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm2-3a2 2 0 1 1-4 0 2 2 0 0 1 4 0zm4 8c0 1-1 1-1 1H3s-1 0-1-1 1-4 6-4 6 3 6 4zm-1-.004c-.001-.246-.154-.986-.832-1.664C11.516 10.68 10.289 10 8 10c-2.29 0-3.516.68-4.168 1.332-.678.678-.83 1.418-.832 1.664h10z"/>
                </svg>
                <button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapse_expense" aria-expanded="false" aria-controls="collapseTwo" style="text-decoration: none;">
                    Expenses
                </button>
        </div>
    </div>
    <div id="collapse_expense" class="collapse" aria-labelledby="headingTwo" data-parent="#accordionExample">
        <div class="card-body" style="padding:10%; padding-top: 0%; padding-bottom: 0%;">
            {% if owner_or_edit %}
            <div class="add-budget-button row" style = "background-color:rgb(192, 208, 218);border-radius: 7.5px;">
                <a class = "btn btn-primary w-100" href = "/budgets/{{budget.id}}/add_expense" role="button">Add Expense</a>
            </div>
            {% endif %}
        </div>
    </div>
</div>
</div>


{% endblock %}

{% block scripts %}
    <script>
    $(document).ready(function () {
        const ctx = document.getElementById('Expense').getContext('2d');
        const labels = [{% for i in expense_cat %} "{{ i }}", {% endfor %}];
        const dates = [{% for i in expenseincome.date %} "{{ i }}", {% endfor %}];
        console.log(dates);
        const Expense = new Chart(ctx, {
        type: 'bar',
        data: {
            labels: [{% for i in expense_cat %} "{{ i }}", {% endfor %}],
            datasets: [{
                label: 'Expenses',
                data: [{% for i in expense_amt %}{{ i }}, {% endfor %}],
                backgroundColor: [
                    'rgba(255, 99, 132, 0.2)',
                    'rgba(54, 162, 235, 0.2)',
                    'rgba(255, 206, 86, 0.2)',
                    'rgba(75, 192, 192, 0.2)',
                    'rgba(153, 102, 255, 0.2)',
                    'rgba(255, 159, 64, 0.2)'
                ],
                borderColor: [
                    'rgba(255, 99, 132, 1)',
                    'rgba(54, 162, 235, 1)',
                    'rgba(255, 206, 86, 1)',
                    'rgba(75, 192, 192, 1)',
                    'rgba(153, 102, 255, 1)',
                    'rgba(255, 159, 64, 1)'
                ],
                borderWidth: 1
            }]
        },
        options: {
            scales: {
                y: {
                    beginAtZero: true
                },
                title: {
                    display: true,
                    text: 'Expense'
                }
            }
        }
    });
    });

    $(document).ready(function () {
        const ctx = document.getElementById('Income').getContext('2d');
        const Income = new Chart(ctx, {
        type: 'bar',
        data: {
            labels: [{% for i in income_cat %} "{{ i }}", {% endfor %}],
            datasets: [{
                label: 'Incomes',
                data: [{% for i in income_amt %}{{ i }}, {% endfor %}],
                backgroundColor: [
                    'rgba(255, 99, 132, 0.2)',
                    'rgba(54, 162, 235, 0.2)',
                    'rgba(255, 206, 86, 0.2)',
                    'rgba(75, 192, 192, 0.2)',
                    'rgba(153, 102, 255, 0.2)',
                    'rgba(255, 159, 64, 0.2)'
                ],
                borderColor: [
                    'rgba(255, 99, 132, 1)',
                    'rgba(54, 162, 235, 1)',
                    'rgba(255, 206, 86, 1)',
                    'rgba(75, 192, 192, 1)',
                    'rgba(153, 102, 255, 1)',
                    'rgba(255, 159, 64, 1)'
                ],
                borderWidth: 1
            }]
        },
        options: {
            scales: {
<<<<<<< HEAD
                yAxes: [{
                    ticks: {
                        beginAtZero: true
                    }
                }]
=======
                y: {
                    beginAtZero: true
                },
                title: {
                    display: true,
                    text: 'Income'
                }
>>>>>>> a8c722c0af90821e0d63d4139c05e12a8e426f5b
            }
        }
    });
    });
    </script>
{% endblock %}

{% block content %}

    <h2 style="margin-top:2%;">{{budget.name}} Dashboard</h2>



    <div class="container">
  <h4><u>Recent Expenses and Incomes </u></h4><br>
  <table id ="myTable" class="table table-light table-striped table-bordered table-sm">
    <thead>
      <tr>
        <th class="th-sm">Name</th>
        <th class="th-sm">Amount</th>
        <th class="th-sm">Date</th>
        <th class="th-sm">Category</th>
      </tr>
    </thead>
    <tbody>
    {% if d %}
    {% for i in expenseincome %}
      <tr>
        <td>{{i.name}}</td>
        {% if i.category_id.is_income_category %}
            <td style="color:green">{{i.amount}}</td>
        {% else %}
            <td style="color:red">{{i.amount}}</td>
        {% endif %}
        <td>{{i.date}}</td>
        <td>{{i.category_id}}</td>
      </tr>
    {% endfor %}
    {% endif %}
    </tbody>
  </table>
</div>

    <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
    {% for msg in messages %}
        <script>
            swal('{{msg}}');
        </script>
    {% endfor %}

    <!-- <canvas id="myChart" width="400" height="100"></canvas> -->
    <canvas id="Expense" width="400" height="100"></canvas>
    <canvas id="Income" width="400" height="100"></canvas>



<script>
$('#myTable').DataTable();
</script>

{% endblock %}




